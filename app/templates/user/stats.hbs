<h3>Complétion</h3>

{{#with model.stat.completion as |total|}}
	<table>
		<tr>
			<th class="noborder" colspan={{if standard 7 25}}></th>
			{{#unless standard}}
				<th colspan="9">Année du Kraken</th>
			{{/unless}}
			<th colspan="9">Année du Mammouth</th>
			<th colspan="6">Année du Corbeau</th>
		</tr>

		<tr>
			<th class="format">
				<img src={{concat "/assets/" (if standard "standard" "wild") ".png"}} class="pointer" {{action 'toggleFormat'}} />
			</th>
			{{#each model.cardsets as |set|}}
				{{#if (or (not standard) set.standard)}}
					<th colspan="3">
						<img src={{set.image}} title={{set.name_fr}} alt={{set.name_fr}} height="50px"/>
					</th>
				{{/if}}
			{{/each}}
			<th colspan="3">TOTAL</th>
			<th>%</th>
		</tr>

		{{#each ordered_rarities as |rarity|}}
			<tr>
				<th>{{rarity.name_fr}}</th>
				{{#each model.cardsets as |set|}}
					{{#if (or (not standard) set.standard)}}
						{{#if (get (get (get (get total.cardsets set.id) "rarities") rarity.id) "total")}}
							<td class="stat1">
								{{#link-to 'user.missing' model.user.id (query-params cardset=set.id rarity=rarity.id)}}
									{{get (get (get (get total.cardsets set.id) "rarities") rarity.id) "owned"}}
								{{/link-to}}
							</td>
							<td class="stat2">/</td>
							<td class="stat3">{{get (get (get (get total.cardsets set.id) "rarities") rarity.id) "total"}}</td>
						{{else}}
							<td colspan="3"></td>
						{{/if}}
					{{/if}}
				{{/each}}
				<th class="stat1">
					{{#link-to 'user.missing' model.user.id (query-params rarity=rarity.id)}}
						{{get (get total.rarities rarity.id) (if standard "owned_std" "owned")}}
					{{/link-to}}
				</th>
				<th class="stat2">/</th>
				<th class="stat3">{{get (get total.rarities rarity.id) (if standard "total_std" "total")}}</th>
				<th class="percent">
					{{round (mult 100 (div (get (get total.rarities rarity.id) (if standard "owned_std" "owned")) (get (get total.rarities rarity.id) (if standard "total_std" "total"))))}}&nbsp;%
				</th>
			</tr>
		{{/each}}

		<tr>
			<th>TOTAL</th>
			{{#each model.cardsets as |set|}}
				{{#if (or (not standard) set.standard)}}
					<th class="stat1">
						{{#link-to 'user.missing' model.user.id (query-params cardset=set.id)}}
							{{get (get total.cardsets set.id) "owned"}}
						{{/link-to}}
					</th>
					<th class="stat2">/</th>
					<th class="stat3">{{get (get total.cardsets set.id) "total"}}</th>
				{{/if}}
			{{/each}}
			<th class="stat1">
				{{#link-to 'user.missing' model.user.id}}
					{{if standard total.owned_std total.owned}}
				{{/link-to}}
			</th>
			<th class="stat2">/</th>
			<th class="stat4">{{if standard total.total_std total.total}}</th>
		</tr>

		<tr>
			<th>%</th>
			{{#each model.cardsets as |set|}}
				{{#if (or (not standard) set.standard)}}
					<th colspan="3" class="percent">
						{{round (mult 100 (div (get (get total.cardsets set.id) "owned") (get (get total.cardsets set.id) "total")))}} %
					</th>
				{{/if}}
			{{/each}}
			<th colspan="3" class="percent">
				{{round (mult 100 (div (if standard total.owned_std total.owned) (if standard total.total_std total.total)))}}&nbsp;%
			</th>
		</tr>
	</table>

	<br/>

	<table>
		<tr>
			<th class="format">
				<img src={{concat "/assets/" (if standard "standard" "wild") ".png"}} class="pointer" {{action 'toggleFormat'}} />
			</th>
			{{#each model.cardclasses as |cardclass|}}
				<th colspan="3">
					<img src={{cardclass.image}} title={{cardclass.name_fr}} alt={{cardclass.name_fr}} height="50px"/>
				</th>
			{{/each}}
			<th colspan="3">TOTAL</th>
			<th>%</th>
		</tr>

		{{#each ordered_rarities as |rarity|}}
			<tr>
				<th>{{rarity.name_fr}}</th>
				{{#each model.cardclasses as |cardclass|}}
					<td class="stat1">
						{{#link-to 'user.missing' model.user.id (query-params class=cardclass.id rarity=rarity.id)}}
							{{get (get (get (get total.cardclasses cardclass.id) "rarities") rarity.id) (if standard "owned_std" "owned")}}
						{{/link-to}}
					</td>
					<td class="stat2">/</td>
					<td class="stat3">{{get (get (get (get total.cardclasses cardclass.id) "rarities") rarity.id) (if standard "total_std" "total")}}</td>
				{{/each}}
				<th class="stat1">
					{{#link-to 'user.missing' model.user.id (query-params rarity=rarity.id)}}
						{{get (get total.rarities rarity.id) (if standard "owned_std" "owned")}}
					{{/link-to}}
				</th>
				<th class="stat2">/</th>
				<th class="stat3">{{get (get total.rarities rarity.id) (if standard "total_std" "total")}}</th>
				<th class="percent">
					{{round (mult 100 (div (get (get total.rarities rarity.id) (if standard "owned_std" "owned")) (get (get total.rarities rarity.id) (if standard "total_std" "total"))))}}&nbsp;%
				</th>
			</tr>
		{{/each}}

		<tr>
			<th>TOTAL</th>
			{{#each model.cardclasses as |cardclass|}}
				<th class="stat1">
					{{#link-to 'user.missing' model.user.id (query-params class=cardclass.id)}}
						{{get (get total.cardclasses cardclass.id) (if standard "owned_std" "owned")}}
					{{/link-to}}
				</th>
				<th class="stat2">/</th>
				<th class="stat3">{{get (get total.cardclasses cardclass.id) (if standard "total_std" "total")}}</th>
			{{/each}}
			<th class="stat1">
				{{#link-to 'user.missing' model.user.id}}
					{{if standard total.owned_std total.owned}}
				{{/link-to}}
			</th>
			<th class="stat2">/</th>
			<th class="stat4">{{if standard total.total_std total.total}}</th>
		</tr>

		<tr>
			<th>%</th>
			{{#each model.cardclasses as |cardclass|}}
				<th colspan="3" class="percent">
					{{round (mult 100 (div (get (get total.cardclasses cardclass.id) (if standard "owned_std" "owned")) (get (get total.cardclasses cardclass.id) (if standard "total_std" "total"))))}} %
				</th>
			{{/each}}
			<th colspan="3" class="percent">
				{{round (mult 100 (div (if standard total.owned_std total.owned) (if standard total.total_std total.total)))}}&nbsp;%
			</th>
		</tr>
	</table>
{{/with}}

<h3>Diversité</h3>

{{#with model.stat.total as |total|}}
	<table>
		<tr>
			<th class="noborder" colspan={{if standard 7 25}}></th>
			{{#unless standard}}
				<th colspan="9">Année du Kraken</th>
			{{/unless}}
			<th colspan="9">Année du Mammouth</th>
			<th colspan="6">Année du Corbeau</th>
		</tr>

		<tr>
			<th class="format">
				<img src={{concat "/assets/" (if standard "standard" "wild") ".png"}} class="pointer" {{action 'toggleFormat'}} />
			</th>
			{{#each model.cardsets as |set|}}
				{{#if (or (not standard) set.standard)}}
					<th colspan="3">
						<img src={{set.image}} title={{set.name_fr}} alt={{set.name_fr}} height="50px"/>
					</th>
				{{/if}}
			{{/each}}
			<th colspan="3">TOTAL</th>
			<th>%</th>
		</tr>

		{{#each ordered_rarities as |rarity|}}
			<tr>
				<th>{{rarity.name_fr}}</th>
				{{#each model.cardsets as |set|}}
					{{#if (or (not standard) set.standard)}}
						{{#if (get (get (get (get total.cardsets set.id) "rarities") rarity.id) "total")}}
							<td class="stat1">
								{{#link-to 'user.missing' model.user.id (query-params cardset=set.id rarity=rarity.id)}}
									{{get (get (get (get total.cardsets set.id) "rarities") rarity.id) "owned"}}
								{{/link-to}}
							</td>
							<td class="stat2">/</td>
							<td class="stat3">{{get (get (get (get total.cardsets set.id) "rarities") rarity.id) "total"}}</td>
						{{else}}
							<td colspan="3"></td>
						{{/if}}
					{{/if}}
				{{/each}}
				<th class="stat1">
					{{#link-to 'user.missing' model.user.id (query-params rarity=rarity.id)}}
						{{get (get total.rarities rarity.id) (if standard "owned_std" "owned")}}
					{{/link-to}}
				</th>
				<th class="stat2">/</th>
				<th class="stat3">{{get (get total.rarities rarity.id) (if standard "total_std" "total")}}</th>
				<th class="percent">
					{{round (mult 100 (div (get (get total.rarities rarity.id) (if standard "owned_std" "owned")) (get (get total.rarities rarity.id) (if standard "total_std" "total"))))}}&nbsp;%
				</th>
			</tr>
		{{/each}}

		<tr>
			<th>TOTAL</th>
			{{#each model.cardsets as |set|}}
				{{#if (or (not standard) set.standard)}}
					<th class="stat1">
						{{#link-to 'user.missing' model.user.id (query-params cardset=set.id)}}
							{{get (get total.cardsets set.id) "owned"}}
						{{/link-to}}
					</th>
					<th class="stat2">/</th>
					<th class="stat3">{{get (get total.cardsets set.id) "total"}}</th>
				{{/if}}
			{{/each}}
			<th class="stat1">
				{{#link-to 'user.missing' model.user.id}}
					{{if standard total.owned_std total.owned}}
				{{/link-to}}
			</th>
			<th class="stat2">/</th>
			<th class="stat4">{{if standard total.total_std total.total}}</th>
		</tr>

		<tr>
			<th>%</th>
			{{#each model.cardsets as |set|}}
				{{#if (or (not standard) set.standard)}}
					<th colspan="3" class="percent">
						{{round (mult 100 (div (get (get total.cardsets set.id) "owned") (get (get total.cardsets set.id) "total")))}} %
					</th>
				{{/if}}
			{{/each}}
			<th colspan="3" class="percent">
				{{round (mult 100 (div (if standard total.owned_std total.owned) (if standard total.total_std total.total)))}}&nbsp;%
			</th>
		</tr>
	</table>

	<br/>

	<table>
		<tr>
			<th class="format">
				<img src={{concat "/assets/" (if standard "standard" "wild") ".png"}} class="pointer" {{action 'toggleFormat'}} />
			</th>
			{{#each model.cardclasses as |cardclass|}}
				<th colspan="3">
					<img src={{cardclass.image}} title={{cardclass.name_fr}} alt={{cardclass.name_fr}} height="50px"/>
				</th>
			{{/each}}
			<th colspan="3">TOTAL</th>
			<th>%</th>
		</tr>

		{{#each ordered_rarities as |rarity|}}
			<tr>
				<th>{{rarity.name_fr}}</th>
				{{#each model.cardclasses as |cardclass|}}
					<td class="stat1">
						{{#link-to 'user.missing' model.user.id (query-params class=cardclass.id rarity=rarity.id)}}
							{{get (get (get (get total.cardclasses cardclass.id) "rarities") rarity.id) (if standard "owned_std" "owned")}}
						{{/link-to}}
					</td>
					<td class="stat2">/</td>
					<td class="stat3">{{get (get (get (get total.cardclasses cardclass.id) "rarities") rarity.id) (if standard "total_std" "total")}}</td>
				{{/each}}
				<th class="stat1">
					{{#link-to 'user.missing' model.user.id (query-params rarity=rarity.id)}}
						{{get (get total.rarities rarity.id) (if standard "owned_std" "owned")}}
					{{/link-to}}
				</th>
				<th class="stat2">/</th>
				<th class="stat3">{{get (get total.rarities rarity.id) (if standard "total_std" "total")}}</th>
				<th class="percent">
					{{round (mult 100 (div (get (get total.rarities rarity.id) (if standard "owned_std" "owned")) (get (get total.rarities rarity.id) (if standard "total_std" "total"))))}}&nbsp;%
				</th>
			</tr>
		{{/each}}

		<tr>
			<th>TOTAL</th>
			{{#each model.cardclasses as |cardclass|}}
				<th class="stat1">
					{{#link-to 'user.missing' model.user.id (query-params class=cardclass.id)}}
						{{get (get total.cardclasses cardclass.id) (if standard "owned_std" "owned")}}
					{{/link-to}}
				</th>
				<th class="stat2">/</th>
				<th class="stat3">{{get (get total.cardclasses cardclass.id) (if standard "total_std" "total")}}</th>
			{{/each}}
			<th class="stat1">
				{{#link-to 'user.missing' model.user.id}}
					{{if standard total.owned_std total.owned}}
				{{/link-to}}
			</th>
			<th class="stat2">/</th>
			<th class="stat4">{{if standard total.total_std total.total}}</th>
		</tr>

		<tr>
			<th>%</th>
			{{#each model.cardclasses as |cardclass|}}
				<th colspan="3" class="percent">
					{{round (mult 100 (div (get (get total.cardclasses cardclass.id) (if standard "owned_std" "owned")) (get (get total.cardclasses cardclass.id) (if standard "total_std" "total"))))}} %
				</th>
			{{/each}}
			<th colspan="3" class="percent">
				{{round (mult 100 (div (if standard total.owned_std total.owned) (if standard total.total_std total.total)))}}&nbsp;%
			</th>
		</tr>
	</table>
{{/with}}
