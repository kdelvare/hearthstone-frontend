<h3>Complétion</h3>

<table>
	<tr>
		<th class="noborder" colspan={{if standard 7 25}}></th>
		{{#unless standard}}
			<th colspan="9">Année du Kraken</th>
		{{/unless}}
		<th colspan="9">Année du Mammouth</th>
		<th colspan="6">Année du Corbeau</th>
	</tr>

	<tr>
		<th class="format">
			<img src={{concat "/assets/" (if standard "standard" "wild") ".png"}} class="pointer" {{action 'toggleFormat'}} />
		</th>
		{{#each model.cardsets as |set|}}
			{{#if (or (not standard) set.standard)}}
				<th colspan="3">
					<img src={{set.image}} title={{set.name_fr}} alt={{set.name_fr}} height="50px"/>
				</th>
			{{/if}}
		{{/each}}
		<th colspan="3">TOTAL</th>
		<th>%</th>
	</tr>

	{{#each ordered_rarities as |rarity|}}
		<tr>
			<th>{{rarity.name_fr}}</th>
			{{#each model.cardsets as |set|}}
				{{#if (or (not standard) set.standard)}}
					{{#if (get (get (get (get completion.cardsets set.id) "rarities") rarity.id) "total")}}
						<td class="stat1">
							{{#link-to 'user.collection' model.user.id (query-params cardset=set.id rarity=rarity.id own='missing')}}
								{{get (get (get (get completion.cardsets set.id) "rarities") rarity.id) "owned"}}
							{{/link-to}}
						</td>
						<td class="stat2">/</td>
						<td class="stat3">
							<span title="{{round (get (get (get (get completion.cardsets set.id) "rarities") rarity.id) "rate")}}%">
								{{get (get (get (get completion.cardsets set.id) "rarities") rarity.id) "total"}}
							</span>
						</td>
					{{else}}
						<td colspan="3"></td>
					{{/if}}
				{{/if}}
			{{/each}}
			<th class="stat1">
				{{#link-to 'user.collection' model.user.id (query-params rarity=rarity.id own='missing')}}
					{{get (get completion.rarities rarity.id) (if standard "owned_std" "owned")}}
				{{/link-to}}
			</th>
			<th class="stat2">/</th>
			<th class="stat3">{{get (get completion.rarities rarity.id) (if standard "total_std" "total")}}</th>
			<th class="percent">
				{{round (get (get completion.rarities rarity.id) (if standard "rate_std" "rate"))}}&nbsp;%
			</th>
		</tr>
	{{/each}}

	<tr>
		<th>TOTAL</th>
		{{#each model.cardsets as |set|}}
			{{#if (or (not standard) set.standard)}}
				<th class="stat1">
					{{#link-to 'user.collection' model.user.id (query-params cardset=set.id own='missing')}}
						{{get (get completion.cardsets set.id) "owned"}}
					{{/link-to}}
				</th>
				<th class="stat2">/</th>
				<th class="stat3">{{get (get completion.cardsets set.id) "total"}}</th>
			{{/if}}
		{{/each}}
		<th class="stat1">
			{{#link-to 'user.collection' model.user.id (query-params own='missing')}}
				{{if standard completion.owned_std completion.owned}}
			{{/link-to}}
		</th>
		<th class="stat2">/</th>
		<th class="stat4">{{if standard completion.total_std completion.total}}</th>
	</tr>

	<tr>
		<th>%</th>
		{{#each model.cardsets as |set|}}
			{{#if (or (not standard) set.standard)}}
				<th colspan="3" class="percent">
					{{round (get (get completion.cardsets set.id) "rate")}} %
				</th>
			{{/if}}
		{{/each}}
		<th colspan="3" class="percent">
			{{round (if standard completion.rate_std completion.rate)}}&nbsp;%
		</th>
	</tr>

	<tr>
		<th>Paquet utile</th>
		{{#each model.cardsets as |set|}}
			{{#if (or (not standard) (and set.standard (not-eq set.name_fr "Basique")))}}
				<td colspan="3" class="percent">
					<div class="less">
						{{round (get (get (get completion.cardsets set.id) "getnewsum") 1)}}&nbsp;%
						<div class="more">
							<table>
								<tr>
									<th class="noborder"></th>
									<th>Exactement</th>
									<th>Au moins</th>
								</tr>
								{{#each (w "0 1 2 3 4 5") as |getnew|}}
									<tr>
										<th>{{getnew}} nouvelles cartes dans un paquet</th>
										<td class="percent">
											{{round (get (get (get completion.cardsets set.id) "getnew") getnew)}}&nbsp;%
										</td>
										<td class="percent">
											{{round (get (get (get completion.cardsets set.id) "getnewsum") getnew)}}&nbsp;%
										</td>
									</tr>
								{{/each}}
							</table>
						</div>
					</div>
				</td>
			{{else if (eq set.name_fr "Basique")}}
				<td colspan="3" class="percent"/>
			{{/if}}
		{{/each}}
	</tr>
</table>

<br/>

<table>
	<tr>
		<th class="format">
			<img src={{concat "/assets/" (if standard "standard" "wild") ".png"}} class="pointer" {{action 'toggleFormat'}} />
		</th>
		{{#each model.cardclasses as |cardclass|}}
			<th colspan="3">
				<img src={{cardclass.image}} title={{cardclass.name_fr}} alt={{cardclass.name_fr}} height="50px"/>
			</th>
		{{/each}}
		<th colspan="3">TOTAL</th>
		<th>%</th>
	</tr>

	{{#each ordered_rarities as |rarity|}}
		<tr>
			<th>{{rarity.name_fr}}</th>
			{{#each model.cardclasses as |cardclass|}}
				<td class="stat1">
					{{#link-to 'user.collection' model.user.id (query-params class=cardclass.id rarity=rarity.id own='missing')}}
						{{get (get (get (get completion.cardclasses cardclass.id) "rarities") rarity.id) (if standard "owned_std" "owned")}}
					{{/link-to}}
				</td>
				<td class="stat2">/</td>
				<td class="stat3">
					<span title="{{round (get (get (get (get completion.cardclasses cardclass.id) "rarities") rarity.id) (if standard "rate_std" "rate"))}}%">
						{{get (get (get (get completion.cardclasses cardclass.id) "rarities") rarity.id) (if standard "total_std" "total")}}
					</span>
				</td>
			{{/each}}
			<th class="stat1">
				{{#link-to 'user.collection' model.user.id (query-params rarity=rarity.id own='missing')}}
					{{get (get completion.rarities rarity.id) (if standard "owned_std" "owned")}}
				{{/link-to}}
			</th>
			<th class="stat2">/</th>
			<th class="stat3">{{get (get completion.rarities rarity.id) (if standard "total_std" "total")}}</th>
			<th class="percent">
				{{round (get (get completion.rarities rarity.id) (if standard "rate_std" "rate"))}}&nbsp;%
			</th>
		</tr>
	{{/each}}

	<tr>
		<th>TOTAL</th>
		{{#each model.cardclasses as |cardclass|}}
			<th class="stat1">
				{{#link-to 'user.collection' model.user.id (query-params class=cardclass.id own='missing')}}
					{{get (get completion.cardclasses cardclass.id) (if standard "owned_std" "owned")}}
				{{/link-to}}
			</th>
			<th class="stat2">/</th>
			<th class="stat3">{{get (get completion.cardclasses cardclass.id) (if standard "total_std" "total")}}</th>
		{{/each}}
		<th class="stat1">
			{{#link-to 'user.collection' model.user.id (query-params own='missing')}}
				{{if standard completion.owned_std completion.owned}}
			{{/link-to}}
		</th>
		<th class="stat2">/</th>
		<th class="stat4">{{if standard completion.total_std completion.total}}</th>
	</tr>

	<tr>
		<th>%</th>
		{{#each model.cardclasses as |cardclass|}}
			<th colspan="3" class="percent">
				{{round (get (get completion.cardclasses cardclass.id) (if standard "rate_std" "rate"))}} %
			</th>
		{{/each}}
		<th colspan="3" class="percent">
			{{round (if standard completion.rate_std completion.rate)}}&nbsp;%
		</th>
	</tr>
</table>

<h3>Diversité</h3>

<table>
	<tr>
		<th class="noborder" colspan={{if standard 7 25}}></th>
		{{#unless standard}}
			<th colspan="9">Année du Kraken</th>
		{{/unless}}
		<th colspan="9">Année du Mammouth</th>
		<th colspan="6">Année du Corbeau</th>
	</tr>

	<tr>
		<th class="format">
			<img src={{concat "/assets/" (if standard "standard" "wild") ".png"}} class="pointer" {{action 'toggleFormat'}} />
		</th>
		{{#each model.cardsets as |set|}}
			{{#if (or (not standard) set.standard)}}
				<th colspan="3">
					<img src={{set.image}} title={{set.name_fr}} alt={{set.name_fr}} height="50px"/>
				</th>
			{{/if}}
		{{/each}}
		<th colspan="3">TOTAL</th>
		<th>%</th>
	</tr>

	{{#each ordered_rarities as |rarity|}}
		<tr>
			<th>{{rarity.name_fr}}</th>
			{{#each model.cardsets as |set|}}
				{{#if (or (not standard) set.standard)}}
					{{#if (get (get (get (get total.cardsets set.id) "rarities") rarity.id) "total")}}
						<td class="stat1">
							{{#link-to 'user.collection' model.user.id (query-params cardset=set.id rarity=rarity.id own='missing')}}
								{{get (get (get (get total.cardsets set.id) "rarities") rarity.id) "owned"}}
							{{/link-to}}
						</td>
						<td class="stat2">/</td>
						<td class="stat3">
							<span title="{{round (get (get (get (get total.cardsets set.id) "rarities") rarity.id) "rate")}}%">
								{{get (get (get (get total.cardsets set.id) "rarities") rarity.id) "total"}}
							</span>
						</td>
					{{else}}
						<td colspan="3"></td>
					{{/if}}
				{{/if}}
			{{/each}}
			<th class="stat1">
				{{#link-to 'user.collection' model.user.id (query-params rarity=rarity.id own='missing')}}
					{{get (get total.rarities rarity.id) (if standard "owned_std" "owned")}}
				{{/link-to}}
			</th>
			<th class="stat2">/</th>
			<th class="stat3">{{get (get total.rarities rarity.id) (if standard "total_std" "total")}}</th>
			<th class="percent">
				{{round (get (get total.rarities rarity.id) (if standard "rate_std" "rate"))}}&nbsp;%
			</th>
		</tr>
	{{/each}}

	<tr>
		<th>TOTAL</th>
		{{#each model.cardsets as |set|}}
			{{#if (or (not standard) set.standard)}}
				<th class="stat1">
					{{#link-to 'user.collection' model.user.id (query-params cardset=set.id own='missing')}}
						{{get (get total.cardsets set.id) "owned"}}
					{{/link-to}}
				</th>
				<th class="stat2">/</th>
				<th class="stat3">{{get (get total.cardsets set.id) "total"}}</th>
			{{/if}}
		{{/each}}
		<th class="stat1">
			{{#link-to 'user.collection' model.user.id own='missing'}}
				{{if standard total.owned_std total.owned}}
			{{/link-to}}
		</th>
		<th class="stat2">/</th>
		<th class="stat4">{{if standard total.total_std total.total}}</th>
	</tr>

	<tr>
		<th>%</th>
		{{#each model.cardsets as |set|}}
			{{#if (or (not standard) set.standard)}}
				<th colspan="3" class="percent">
					{{round (get (get total.cardsets set.id) "rate")}} %
				</th>
			{{/if}}
		{{/each}}
		<th colspan="3" class="percent">
			{{round (if standard total.rate_std total.rate)}}&nbsp;%
		</th>
	</tr>
</table>

<br/>

<table>
	<tr>
		<th class="format">
			<img src={{concat "/assets/" (if standard "standard" "wild") ".png"}} class="pointer" {{action 'toggleFormat'}} />
		</th>
		{{#each model.cardclasses as |cardclass|}}
			<th colspan="3">
				<img src={{cardclass.image}} title={{cardclass.name_fr}} alt={{cardclass.name_fr}} height="50px"/>
			</th>
		{{/each}}
		<th colspan="3">TOTAL</th>
		<th>%</th>
	</tr>

	{{#each ordered_rarities as |rarity|}}
		<tr>
			<th>{{rarity.name_fr}}</th>
			{{#each model.cardclasses as |cardclass|}}
				<td class="stat1">
					{{#link-to 'user.collection' model.user.id (query-params class=cardclass.id rarity=rarity.id own='missing')}}
						{{get (get (get (get total.cardclasses cardclass.id) "rarities") rarity.id) (if standard "owned_std" "owned")}}
					{{/link-to}}
				</td>
				<td class="stat2">/</td>
				<td class="stat3">
					<span title="{{round (get (get (get (get total.cardclasses cardclass.id) "rarities") rarity.id) (if standard "rate_std" "rate"))}}%">
						{{get (get (get (get total.cardclasses cardclass.id) "rarities") rarity.id) (if standard "total_std" "total")}}
					</span>
				</td>
			{{/each}}
			<th class="stat1">
				{{#link-to 'user.collection' model.user.id (query-params rarity=rarity.id own='missing')}}
					{{get (get total.rarities rarity.id) (if standard "owned_std" "owned")}}
				{{/link-to}}
			</th>
			<th class="stat2">/</th>
			<th class="stat3">{{get (get total.rarities rarity.id) (if standard "total_std" "total")}}</th>
			<th class="percent">
				{{round (get (get total.rarities rarity.id) (if standard "rate_std" "rate"))}}&nbsp;%
			</th>
		</tr>
	{{/each}}

	<tr>
		<th>TOTAL</th>
		{{#each model.cardclasses as |cardclass|}}
			<th class="stat1">
				{{#link-to 'user.collection' model.user.id (query-params class=cardclass.id own='missing')}}
					{{get (get total.cardclasses cardclass.id) (if standard "owned_std" "owned")}}
				{{/link-to}}
			</th>
			<th class="stat2">/</th>
			<th class="stat3">{{get (get total.cardclasses cardclass.id) (if standard "total_std" "total")}}</th>
		{{/each}}
		<th class="stat1">
			{{#link-to 'user.collection' model.user.id (query-params own='missing')}}
				{{if standard total.owned_std total.owned}}
			{{/link-to}}
		</th>
		<th class="stat2">/</th>
		<th class="stat4">{{if standard total.total_std total.total}}</th>
	</tr>

	<tr>
		<th>%</th>
		{{#each model.cardclasses as |cardclass|}}
			<th colspan="3" class="percent">
				{{round (get (get total.cardclasses cardclass.id) (if standard "rate_std" "rate"))}} %
			</th>
		{{/each}}
		<th colspan="3" class="percent">
			{{round (if standard total.rate_std total.rate)}}&nbsp;%
		</th>
	</tr>
</table>
